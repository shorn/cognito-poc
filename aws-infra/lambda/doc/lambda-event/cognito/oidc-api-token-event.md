```
{
  "version": "2.0",
  "routeKey": "$default",
  "rawPath": "/token",
  "rawQueryString": "",
  "headers": {
    "x-amzn-trace-id": "Root=1-626ccd9c-7def5b8b4c3a655606c1ac58",
    "x-forwarded-proto": "https",
    "host": "xxx.lambda-url.ap-southeast-2.on.aws",
    "x-forwarded-port": "443",
    "content-type": "application/x-www-form-urlencoded; charset=UTF-8",
    "x-forwarded-for": "13.54.146.157",
    "accept-encoding": "gzip,deflate",
    "user-agent": "Amazon/Cognito"
  },
  "requestContext": {
    "accountId": "anonymous",
    "apiId": "xxx",
    "domainName": "xxx.lambda-url.ap-southeast-2.on.aws",
    "domainPrefix": "xxx",
    "http": {
      "method": "POST",
      "path": "/token",
      "protocol": "HTTP/1.1",
      "sourceIp": "13.54.146.157",
      "userAgent": "Amazon/Cognito"
    },
    "requestId": "1fba0707-02e3-41c2-b3f8-a9ea1398fa1a",
    "routeKey": "$default",
    "stage": "$default",
    "time": "30/Apr/2022:05:48:12 +0000",
    "timeEpoch": 1651297692985
  },
  "body": "FFFF==",
  "isBase64Encoded": true
}
```

decoded body (wrapped on `&`):

```
grant_type=authorization_code
&client_id=<UserPool IdentityProvider ClientId>
&redirect_uri=https%3A%2F%2F<user pool domain>.auth.<region>.amazoncognito.com%2Foauth2%2Fidpresponse
&client_secret=<github zinc oauth app CLIENT SECRET!>
&code=xxx
```

If `/token` responds successfully with `id_token` and the required  
claims (as defined in the Cognito IdProvider AttributeMapping, for our case,
see `CognitoGithubStack`), then the authentication flow has finsished and
Cognito will redirect back to our app with the tokens below.

Cognito creates a user in the UserPool:
* the `User ID` of the user is unqiurely generated by Cognito, it is not related
  to the data returned by Github
* the `sub` from `/token` is recorded in the UserPool User `identities`
  attribute (in a sub-field called `userId` because that's not confusing at all)
* the `email` from `/token` gets recorded as the email of the user
  * the email is marked verified because `/token` returned
    `email_verified: true`

The info below was observed when I hardcoded the `/token` endpoint to return
some dummy claims.
```shell
curl 'http://localhost:9090/
#access_token=<AccessToken>
&id_token=<IdToken>
&token_type=Bearer
&expires_in=3600' 
```

AccessToken:

```json
{
  "sub": "<UserPool UserId>",
  "cognito:groups": [
    "<UserPool ID>_<UserPool IdProvider name>"
  ],
  "token_use": "access",
  "scope": "openid profile email",
  "auth_time": 1651386303,
  "iss": "https://cognito-idp.<Region>.amazonaws.com/<UserPool ID>",
  "exp": 1651389903,
  "iat": 1651386303,
  "version": 2,
  "jti": "<UUID>",
  "client_id": "<UserPool AppClient ClientID>",
  "username": "<IdProvider Name>_<`sub` returned form `/token`>"
}
```

IdToken:
```json
{
  "at_hash": "_XRnF8PEiKBLb4DjXgzgng",
  "sub": "379e8106-4056-4984-9901-ce222f71184b",
  "cognito:groups": [
    "<UserPool ID>_<IdProvider name>"
  ],
  "email_verified": true,
  "iss": "https://cognito-idp.<Region>.amazonaws.com/<UserPool ID>",
  "cognito:username": "<IdProvider Name>_<`sub` returned form `/token`>",
  "nonce": "xxx",
  "aud": "<UserPool AppClient ClientID>",
  "identities": [
    {
      "userId": "<`sub` returned form `/token`>",
      "providerName": "<UserPool IdProvider name>",
      "providerType": "OIDC",
      "issuer": null,
      "primary": "true",
      "dateCreated": "1651386303661"
    }
  ],
  "token_use": "id",
  "auth_time": 1651386303,
  "exp": 1651389903,
  "iat": 1651386303,
  "jti": "<UUID>",
  "email": "<`email` from `/token`>"
}
```

If `/token` succeeds, but the returned payload does not contain the required
attributes (i.e only contains id_token/access_token) then Cognito will call
the `/userinfo` endpoint (using the Github access_token) before the user
is "signed in".

This may be necessary because the `/token` request had a 1 second timeout, 
according to the code